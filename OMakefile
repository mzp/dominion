# ------------------------------
# camlp4 rules
# ------------------------------
public.UseCamlp4(files) =
	protected.CAMLP4CMO = $(addprefix $(ROOT)/camlp4/,$(addsuffix .cmo,$(files)))
	OCAMLPPFLAGS+=-pp 'camlp4o $(CAMLP4CMO)'
	OCAMLDEPFLAGS+=-pp 'camlp4o $(CAMLP4CMO)'
	export

	.SCANNER: scan-ocaml-%.ml: %.ml $(CAMLP4CMO)

RM=rm -f *~ *.omc
.SUBDIRS: protocol core camlp4

.PHONY: clean
clean:
	$(RM) .omakedb .omakedb.lock

