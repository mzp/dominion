.PHONY: all clean

USE_OCAMLFIND = true

OCAMLPACKS[] =
	extlib
	oUnit
	threads
	ccell
	str


if $(not $(OCAMLFIND_EXISTS))
    eprintln("This project requires ocamlfind, but is was not found.")
    eprintln(You need to install ocamlfind and run "omake --configure".)
    exit 1

OCAMLC=ocamlc -thread

NATIVE_ENABLED=false
BYTE_ENABLED = true
FILES[] =
	base
	hList
	game
	cards
	cc
	server
	client
	socket
	logger
	protocol
	rules
	maybe
	threadUtils

UseCamlp4(pa_monad)
OUnitTest(cards,base cc game cards hList)

OCAMLFLAGS=-annot -w
PROGRAM = dominion
# OCAML_LIBS +=
# OCAML_CLIBS +=
# OCAML_OTHER_LIBS +=
# OCAML_LIB_FLAGS +=
#
.DEFAULT: $(PROGRAM)

OCamlProgram($(PROGRAM), main $(FILES))

clean:
	$(RM) *.cm[iox] *.o $(PROGRAM) *.opt *-runner *.run *.annot